<!DOCTYPE html>
<html lang="bg" xmlns:th="http://www.w3.org/1999/xhtml" xmlns:sec="http://www.w3.org/1999/xhtml">
<head th:replace="~{fragments/head}"></head>
<body class="motor-bg">
<nav th:replace="~{fragments/navbar}"></nav>
<main>
    <div class="container mt-4">
        <div class="row g-4">
            <div class="col-lg-8">
                <div class="card bg-secondary bg-opacity-25 p-3">
                    <img id="largeImage"
                         class="img-fluid rounded mb-3"
                         th:src="'data:image/jpeg;base64,' + ${encoder.encodeToBase64(motorcycle.images.get(motorcycle.mainImageIndex))}"
                         style="max-height: 500px; object-fit: cover;">
                    <div class="row g-2">
                        <div th:each="image : ${motorcycle.images}" class="col-3">
                            <img th:src="'data:image/jpeg;base64,' + ${encoder.encodeToBase64(image)}"
                                 class="img-fluid rounded clickable-thumbnail"
                                 style="cursor:pointer; height:90px; object-fit:cover;">
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-4">
                <div sec:authorize="hasAuthority('ADMIN')" class="mb-3 d-grid gap-2">
                    <form th:if="${!motorcycle.isOffer}"
                          th:action="@{/motorcycles/offers/add/{id}(id=${motorcycle.id})}">
                        <button class="btn btn-outline-danger fw-bold">Добави оферта</button>
                    </form>
                    <form th:if="${motorcycle.isOffer}"
                          th:action="@{/motorcycles/offers/delete/{id}(id=${motorcycle.id})}" method="post">
                        <button class="btn btn-outline-warning fw-bold">Премахни оферта</button>
                    </form>
                    <form th:action="@{/motorcycles/submit-sold/{id}(id=${motorcycle.id})}" method="post">
                        <button class="btn btn-danger fw-bold">Маркирай като продадена</button>
                    </form>
                </div>
                <div class="card bg-secondary bg-opacity-25">
                    <div class="card-body">
                        <h3 class="text-white fw-bold mb-2"
                            th:text="${motorcycle.brand.name} + ' ' + ${motorcycle.model.name}">
                        </h3>
                        <div th:if="${!motorcycle.isOffer}">
                            <h4 class="text-white mb-3"
                                th:text="${motorcycle.price} + ' лв.'"></h4>
                        </div>
                        <div th:if="${motorcycle.isOffer}">
                            <span class="text-white text-decoration-line-through"
                                  th:text="${motorcycle.price} + ' лв.'"></span>
                            <h3 class="text-danger"
                                th:text="${motorcycle.offerPrice} + ' лв.'"></h3>
                        </div>
                        <button class="btn btn-danger w-100 fw-bold my-3"
                                onclick="showPhoneNumber(this)">
                            Обади се
                        </button>
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item bg-transparent text-white">
                                <small class="opacity-50">Двигател</small>
                                <div th:text="${motorcycle.engine}"></div>
                            </li>
                            <li class="list-group-item bg-transparent text-white">
                                <small class="opacity-50">Кубатура</small>
                                <div th:text="${motorcycle.cubicCapacity} + ' куб.см'"></div>
                            </li>
                            <li class="list-group-item bg-transparent text-white">
                                <small class="opacity-50">Мощност</small>
                                <div th:text="${motorcycle.power} + ' к.с.'"></div>
                            </li>
                            <li class="list-group-item bg-transparent text-white">
                                <small class="opacity-50">Скоростна кутия</small>
                                <div th:text="${motorcycle.gearbox}"></div>
                            </li>
                            <li class="list-group-item bg-transparent text-white">
                                <small class="opacity-50">Категория</small>
                                <div th:text="${motorcycle.category}"></div>
                            </li>
                            <li class="list-group-item bg-transparent text-white">
                                <small class="opacity-50">Пробег</small>
                                <div th:text="${motorcycle.mileage} + ' км.'"></div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>
<footer th:replace="~{fragments/footer}"></footer>

<script>
    document.querySelectorAll('.clickable-thumbnail').forEach(img => {
        img.addEventListener('click', () => {
            document.getElementById('largeImage').src = img.src;
        });
    });

    function showPhoneNumber(btn) {
        btn.textContent = '0888 123 456';
    }
</script>

</body>
</html>